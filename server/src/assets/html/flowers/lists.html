<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>HoneyNote | 蜜源リスト</title>

<style>
    @import url('/honey_note/css/common_list.css');
</style>
<script type="module">
  import init, { flower_list_main, filter_rows } from '/honey_note/javascript/front.js';
  init().then(() => {
    flower_list_main();
  });

async function filterTable() {
  await init(); // Initialize WebAssembly
  const input = document.getElementById("searchInput").value.toLowerCase();
  
  // Prepare data: Extract all rows' text content
  const rows = Array.from(document.querySelectorAll("#flowerTable tbody tr"))
      .map(row => Array.from(row.cells).map(cell => cell.textContent).join(" "));

  // Call the WebAssembly function
  const matchingIndices = filter_rows(input, rows);

  // Update display
  const tableRows = document.querySelectorAll("#flowerTable tbody tr");
  tableRows.forEach((row, index) => {
      row.style.display = matchingIndices.includes(index) ? "" : "none";
  });
}

document.getElementById("searchInput").addEventListener("keyup", filterTable);
</script>
</head>
<body>
<header>
  <nav>
    <div class="nav-left">
      <a class="logo" href="/honey_note/index.html">
        <img src="/honey_note/icons/honeu_note_logo_v0.0.1.jpeg" alt="HoneyNote Logo">
        HoneyNote
      </a>
    </div>
    <div class="nav-links">
      <a href="/honey_note/honeys/lists.html">はちみつ一覧</a>
      <a href="/honey_note/flowers/lists.html">蜜源リスト</a>
      <a href="/honey_note/beekeepers/lists.html">養蜂場</a>
    </div>
  </nav>
</header>

<div class="search-wrap">
  <input id="searchInput" placeholder="ID・名前・開花時期で検索…" autocomplete="off">
</div>

<main>
  <h1 class="page-title">蜜源リスト</h1>
  <table id="flowerTable">
    <thead>
      <tr>
        <th>ID</th><th>名前 (JP)</th><th>名前 (EN)</th><th>ノート</th>
      </tr>
    </thead>
    <tbody id="flower_list_table_body"><!-- JS で生成 --></tbody>
  </table>
</main>

</body>
</html>
